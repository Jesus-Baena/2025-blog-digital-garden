# Copilot Instructions

This is a **Quartz v4-powered digital garden/blog** that publishes Obsidian notes as a static website. It's Jesus Baena's personal knowledge management system made public, combining blog posts with an interconnected knowledge garden.

## Architecture Overview

- **Quartz v4**: Static site generator that transforms Markdown into a web-navigable knowledge graph
- **Obsidian-first workflow**: Content is written in Obsidian, then published via Quartz
- **TypeScript/Node.js**: Built with modern JS tooling, requires Node.js >=22
- **Docker deployment**: Multi-stage build with NGINX serving, deployed to Cloudflare Pages

## Key Configuration Files

- `quartz.config.ts`: Main Quartz configuration with plugins, theme, and site metadata
- `quartz.layout.ts`: Page layout components and UI structure
- `content/`: All Markdown content, mirrors Obsidian vault structure
- `public/`: Generated static site output

## Content Structure & Patterns

### Content Organization
```
content/
├── index.md              # Site homepage
├── 1. POSTs.md           # Blog posts index  
├── 2. TECH.md            # Technical content index
├── 3. PROJECTS.md        # Projects showcase
├── 4. ABOUT.md           # About page
└── 00. STOCK/            # Working notes (hidden from explorer)
```

### Frontmatter Standards
All content files use YAML frontmatter:
```yaml
---
title: Page Title
draft: false      # Controls publication
tags: [tag1, tag2] # For categorization
---
```

### Obsidian Features
- **Wiki-style links**: `[[Link to Page]]` for internal navigation
- **Image embeds**: `![[image.png]]` for local images in `content/` directory
- **Block quotes**: Uses `> [!CONCEPT]` callout syntax
- **Backlinks**: Automatically generated by Quartz from `[[]]` links

## Development Workflow

### Local Development
```bash
npm run quartz build --serve    # Build and serve locally
npm run docs                    # Serve docs specifically
npm run format                  # Format with Prettier
npm run check                   # TypeScript + format check
```

### Docker Development
```bash
docker build -t baena-blog .
docker-compose up              # Runs on port 8086
```

### Key Build Concepts
- **Quartz CLI**: `./quartz/bootstrap-cli.mjs` is the main entry point
- **Plugins**: Content transformations defined in `quartz.config.ts`
- **Two-stage build**: Content processing → Static generation
- **Hot reload**: Available in serve mode for development

## Content Conventions

### Explorer Filtering
The left sidebar explorer hides `00. STOCK/` folder via filter in `quartz.layout.ts`:
```typescript
filterFn: (node) => node.displayName !== "00. STOCK"
```

### Image Handling
- Images stored directly in `content/` alongside Markdown
- Obsidian paste workflow: Images auto-named with timestamps
- Quartz processes and serves images automatically

### Link Patterns
- **Internal**: `[[Page Name]]` for wiki-style navigation
- **External**: Standard Markdown `[text](url)` format
- **Headers**: `## Header` creates anchor links automatically

## Plugin Architecture

Key plugins in `quartz.config.ts`:
- `ObsidianFlavoredMarkdown`: Processes `[[]]` links and callouts
- `CreatedModifiedDate`: Git-based timestamps with frontmatter priority
- `CrawlLinks`: Builds the knowledge graph connections
- `CustomOgImages`: Generates social media previews (can be disabled for faster builds)

## Deployment Notes

- **Cloudflare Pages**: Auto-deploys from GitHub commits
- **Custom domain**: `baena.blog` configured in Quartz config
- **Analytics**: Plausible integration configured
- **Performance**: SPA mode enabled, popovers for link previews

## Common Tasks

**Adding new content**: Create `.md` file in `content/`, follow frontmatter pattern
**Publishing drafts**: Set `draft: false` in frontmatter
**Hiding from navigation**: Place in `00. STOCK/` or add to explorer filter
**Styling changes**: Modify theme colors in `quartz.config.ts`
**Layout updates**: Edit components in `quartz.layout.ts`

## Troubleshooting

- **Build failures**: Check Node.js version (>=22 required)
- **Missing links**: Ensure `[[]]` links match exact file names
- **Images not loading**: Verify images are in `content/` directory
- **Slow builds**: Comment out `CustomOgImages` plugin in config